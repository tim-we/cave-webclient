{"version":3,"sources":["webpack:///webpack/bootstrap 372be1450690e97c64c0","webpack:///./ts/Controller.ts","webpack:///./ts/Model.ts","webpack:///./ts/Player.ts","webpack:///./ts/Vector.ts","webpack:///./ts/Map.ts","webpack:///./ts/View.ts"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;AC7DA;AACA,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;;;;;;;AC5BA;AACA,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,OAAO;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;;;;;;;ACtDA;AACA,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACnBA;AACA,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC/BA;AACA,8CAA8C,cAAc;AAC5D;AACA;AACA;;;;;;;;ACJA;AACA,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"./js/bundle/game.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 372be1450690e97c64c0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst Model_1 = require(\"./Model\");\r\nconst View = require(\"./View\");\r\nvar ws = null;\r\nvar model = null;\r\nfunction connect() {\r\n    ws = new WebSocket(\"ws://destroids.io:8000\");\r\n}\r\nwindow.addEventListener(\"load\", () => {\r\n    let canvas = document.getElementById(\"game\");\r\n    View.setCanvas(canvas);\r\n    test();\r\n});\r\nfunction mainloop() {\r\n    if (model) {\r\n        View.draw(model);\r\n        model.update();\r\n    }\r\n    window.requestAnimationFrame(mainloop);\r\n}\r\nfunction test() {\r\n    model = new Model_1.default({\r\n        n: 1,\r\n        i: 0,\r\n        t: -3,\r\n        names: [\"Bob\"]\r\n    });\r\n}\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ts/Controller.ts\n// module id = 0\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst Player_1 = require(\"./Player\");\r\nconst Map_1 = require(\"./Map\");\r\nclass Model {\r\n    constructor(data) {\r\n        this.userInput = false;\r\n        let n = data.n;\r\n        console.assert(n > 0);\r\n        console.assert(data.names.length === n);\r\n        console.assert(data.t < 0);\r\n        this.Time = data.t;\r\n        this.TimeDelta = 0.0;\r\n        this.Players = new Array(n);\r\n        for (let i = 0; i < n; i++) {\r\n            this.Players[i] = new Player_1.default(data.names[i]);\r\n        }\r\n        this.Player = this.Players[data.i];\r\n        Object.freeze(this.Players);\r\n        this.Map = new Map_1.default();\r\n    }\r\n    setUserInput(pressed) {\r\n        this.userInput = pressed;\r\n    }\r\n    updateData(data) {\r\n        console.assert(data.t >= this.NextTime);\r\n        console.assert(data.ps.length === this.Players.length);\r\n        console.assert(data.as.length === this.Players.length);\r\n        this.TimeDelta = Math.max(32, data.t - this.Time);\r\n        this.NextTime = data.t;\r\n        this.Players.forEach((p, i) => {\r\n            let pos = data.ps[i];\r\n            p.updateData(pos.x, pos.y, data.as[i]);\r\n        });\r\n    }\r\n    update() {\r\n        if (this.TimeDelta <= 0.0) {\r\n            return;\r\n        }\r\n        let d = performance.now() - this.LastUpdate;\r\n        this.LastUpdate = performance.now();\r\n        if (this.Time > this.NextTime) {\r\n            this.Time = this.NextTime;\r\n        }\r\n        else {\r\n            this.Time += d;\r\n        }\r\n        let t = d / this.TimeDelta;\r\n        t = Math.max(Math.min(t, 2.0), 0.0);\r\n        this.Players.forEach(p => {\r\n            p.move(t);\r\n        });\r\n    }\r\n}\r\nexports.default = Model;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ts/Model.ts\n// module id = 1\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst Vector_1 = require(\"./Vector\");\r\nclass Player {\r\n    constructor(name) {\r\n        this.Position = new Vector_1.default(0, 0);\r\n        this.PDelta = new Vector_1.default(0, 0);\r\n        this.PDeltaLength = 0;\r\n        this.Alive = true;\r\n    }\r\n    updateData(px, py, alive) {\r\n        this.PDelta.diff2d(px, py);\r\n        this.PDeltaLength = this.PDelta.length();\r\n        this.Alive = alive;\r\n    }\r\n    move(a) {\r\n        Vector_1.default.axpy(a, this.PDelta, this.Position);\r\n    }\r\n}\r\nexports.default = Player;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ts/Player.ts\n// module id = 2\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nclass Vector {\r\n    constructor(x = 0.0, y = 0.0) {\r\n        this.data = new Float64Array(2);\r\n        this.data[0] = x;\r\n        this.data[1] = y;\r\n    }\r\n    getX() {\r\n        return this.data[0];\r\n    }\r\n    getY() {\r\n        return this.data[1];\r\n    }\r\n    diff2d(x, y) {\r\n        this.data[0] = x - this.data[0];\r\n        this.data[1] = y - this.data[1];\r\n    }\r\n    length() {\r\n        return Math.sqrt(this.data[0] * this.data[0] + this.data[1] * this.data[1]);\r\n    }\r\n    static axpy(a, x, y) {\r\n        y.data[0] = a * x.data[0] + y.data[0];\r\n        y.data[1] = a * x.data[1] + y.data[1];\r\n    }\r\n    static distance2(a, b) {\r\n        let dx = a.data[0] - b.data[0];\r\n        let dy = a.data[1] - b.data[1];\r\n        return dx * dx + dy * dy;\r\n    }\r\n}\r\nexports.default = Vector;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ts/Vector.ts\n// module id = 3\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nclass Map {\r\n}\r\nexports.default = Map;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ts/Map.ts\n// module id = 4\n// module chunks = 0","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar webgl = null;\r\nfunction setCanvas(canvas) {\r\n    try {\r\n        webgl = canvas.getContext(\"webgl\") || canvas.getContext(\"experimental-webgl\");\r\n    }\r\n    catch (e) {\r\n        console.warn(\"Error initializing webgl.\");\r\n    }\r\n    if (!webgl) {\r\n        alert(\"Unable to initialize WebGL. Your browser may not support it.\");\r\n    }\r\n}\r\nexports.setCanvas = setCanvas;\r\nfunction draw(model) {\r\n    let gl = webgl;\r\n    gl.clear(gl.COLOR_BUFFER_BIT);\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, model.Map.VertexBuffer);\r\n    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\r\n}\r\nexports.draw = draw;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./ts/View.ts\n// module id = 5\n// module chunks = 0"],"sourceRoot":""}